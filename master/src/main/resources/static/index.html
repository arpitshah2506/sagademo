<!DOCTYPE html>
<html>
<head>
    <title>Saga Trigger</title>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // 1Ô∏è‚É£ Setup WebSocket connection
            const socket = new WebSocket(`ws://${window.location.host}/ws/saga`);

            socket.onopen = () => console.log("‚úÖ WebSocket connected");
            socket.onclose = () => console.log("‚ùå WebSocket disconnected");
            socket.onerror = () => console.log("‚ö†Ô∏è WebSocket error");

            socket.onmessage = function (event) {
                alert("üéØ SAGA RESULT: " + event.data);
            };

            // 2Ô∏è‚É£ Handle POST buttons using fetch()
            function triggerSaga(path) {
                fetch(path, { method: "POST" })
                    .then(response => response.text())
                    .then(text => console.log("‚úÖ Saga triggered:", text))
                    .catch(err => console.error("‚ùå Trigger failed:", err));
            }

            // 3Ô∏è‚É£ Bind click listeners
            document.getElementById("successBtn").addEventListener("click", function () {
                triggerSaga("/saga/success");
            });

            document.getElementById("failureBtn").addEventListener("click", function () {
                triggerSaga("/saga/failure");
            });
        });
    </script>
</head>
<body>
    <h2>Trigger Saga</h2>
    <button id="successBtn">Trigger Success Saga</button>
    <br/><br/>
    <button id="failureBtn">Trigger Failure Saga</button>
</body>
</html>
